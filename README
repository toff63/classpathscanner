This code is explained on my blog http://christophe-marchal.blogspot.com
